extends ../layout.jade

block lead

block content
   div(class="ui container")
      h2(class="ui header") Post - #{post.Title}
      a(href="/forum/#{forumName}") Back to #{forumTitle}...
      div(class="ui raised text segment message")          
         div(class="ui relaxed list")
            div(class="ui comments")
               - for reply in replies
                  div(class="comment")
                     a(class="avatar")
                        img(src="/images/profile-icon.png")
                     div(class="content")
                        a(class="author")= reply.UserName
                        div(class="metadata")
                           span(class="date")= reply.CreatedOn.toUTCString()
                        div(class="text")
                           |!{markdownify(reply.Content)}
                        div(class="actions")
                           - if (everyauth.loggedIn && (reply.CreatedBy == everyauth.user.Id))
                              a(class="Reply" href="/forum/postreply/#{reply.Id}/edit") Edit
                              a(class="Reply" href="/forum/postreply/#{reply.Id}/delete") Delete
                           - else if (everyauth.loggedIn && everyauth.user.IsAdmin == 1)
                              a(class="Reply" href="/forum/postreply/#{reply.Id}/edit") Edit (Admin)
                              a(class="Reply" href="/forum/postreply/#{reply.Id}/delete") Delete (Admin)
                  div(class="ui divider")
         - if (everyauth.loggedIn)
            h3("ui header") New Reply
            form(class="ui form" method="post" action="/forum/posts/#{post.Id}/addReply")
               div(class="field")
                  label Message
                  textarea(rows=5 name="replyContent")
               button(class="ui button" type="submit") Reply to Post
               - if (everyauth.loggedIn && (reply.CreatedBy == everyauth.user.Id))
                  button(class="ui red button" type="submit") Delete Post
               - else if (everyauth.loggedIn && everyauth.user.IsAdmin == 1)
                  button(class="ui red button" type="submit") Delete Post (Admin)